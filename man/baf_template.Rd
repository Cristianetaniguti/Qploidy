% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm_utils.R
\name{baf_template}
\alias{baf_template}
\title{Build a polyploid BAF comb template for a given copy number}
\usage{
baf_template(c, M = 101, bw = 0.03, floor_eps = 1e-08)
}
\arguments{
\item{c}{Integer copy number (e.g., 2 for diploid, 4 for tetraploid).}

\item{M}{Integer, number of histogram bins over \eqn{[0,1]}.}

\item{bw}{Numeric, kernel bandwidth (standard deviation) of the Gaussians.}

\item{floor_eps}{Small positive numeric added to the template before
renormalization to ensure strictly positive probabilities.}
}
\value{
A numeric vector of length \code{M} summing to 1: the BAF template
  for copy number \code{c}.
}
\description{
Constructs a discrete BAF density template on \eqn{[0,1]} for copy number
\code{c}, by placing Gaussian kernels at genotype fractions \eqn{d/c},
\eqn{d=0,\dots,c}. Reflection kernels keep mass within \eqn{[0,1]}.
}
\details{
Peaks are centered at \eqn{d/c}. Binomial weights \code{dbinom(0:c, c, 0.5)}
provide a reasonable default relative mass across clusters. Boundary
reflections (\eqn{\mu,-\mu,2-\mu}) prevent leakage outside \eqn{[0,1]}.
}
\examples{
t4 <- baf_template(4, M = 121, bw = 0.03)
sum(t4)            # 1
which.max(t4)      # near BAF = 0.5 for c = 4

}
