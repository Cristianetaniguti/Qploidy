% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm_utils.R
\name{plot_cn_track}
\alias{plot_cn_track}
\title{Plot copy-number segments per window with posterior shading}
\usage{
plot_cn_track(
  hmm_CN,
  sample_id = NULL,
  cn_min = NULL,
  cn_max = NULL,
  show_window_lines = FALSE,
  include_first_in_chr = FALSE,
  line_color = "grey60",
  line_alpha = 0.6,
  line_width = 0.3,
  line_linetype = "dashed"
)
}
\arguments{
\item{hmm_CN}{A data frame with one row per window containing at least the
columns:
\itemize{
  \item \code{Sample}: sample identifier (character/factor)
  \item \code{Chr}: chromosome/contig name
  \item \code{Start}, \code{End}: genomic window bounds (numeric or integer)
  \item \code{CN_call}: integer copy-number call for the window
  \item \code{post_CN*}: posterior probabilities for each CN state, with
    column names of the form \code{post_CN2}, \code{post_CN3}, â€¦ matching
    the CN grid used during HMM inference
}}

\item{sample_id}{Character scalar. Which sample from \code{hmm_CN$Sample} to
display. Defaults to the first unique value in \code{hmm_CN$Sample}.}

\item{cn_min, cn_max}{Numeric scalars giving the y-axis limits for CN. By
default they span the minimum/maximum of \code{hmm_CN$CN_call}.}
}
\value{
A \code{ggplot} object. Print it to render, or add layers/scales as
  needed.
}
\description{
Draws a genome track where each window is plotted as a horizontal segment at
its called copy number (CN) and colored by the posterior probability of that
call. Panels (facets) are split by chromosome.
}
\details{
The color mapped to each segment is the posterior probability corresponding to
the called state in that window. Posterior columns are detected by the prefix
\code{"post_CN"} and matched to \code{CN_call} values, so the function is
agnostic to the specific CN grid (e.g., 2:6, 2:8).
}
\section{Expected columns}{

The function assumes posterior columns named exactly \code{post_CN<k>} for
each copy-number state \code{k}. If your column naming differs, rename them
before calling this function.
}

\examples{
\dontrun{
library(dplyr)
library(ggplot2)
toy <- data.frame(
  Sample   = "S1",
  Chr      = c("chr1","chr1","chr1"),
  Start    = c(1, 1e6, 2e6),
  End      = c(1e6-1, 2e6-1, 3e6-1),
  CN_call  = c(2,3,2),
  post_CN2 = c(0.95, 0.05, 0.9),
  post_CN3 = c(0.05, 0.94, 0.1)
)
plot_cn_track(toy, sample_id = "S1")
}

}
