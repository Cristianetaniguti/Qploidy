% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm_utils.R
\name{plot_cn_track}
\alias{plot_cn_track}
\title{Plot copy-number segments per window with posterior shading and BAF}
\usage{
plot_cn_track(
  hmm_CN,
  qploidy_standarize_result,
  sample_id = NULL,
  cn_min = NULL,
  cn_max = NULL,
  show_window_lines = FALSE,
  include_first_in_chr = FALSE,
  line_color = "grey60",
  line_alpha = 0.6,
  line_width = 0.3,
  line_linetype = "dashed",
  heights = c(2, 2.5)
)
}
\arguments{
\item{hmm_CN}{An object of class \code{hmm_CN} (output from \code{hmm_estimate_CN}), containing a \code{result} data frame with one row per window and columns: \code{Sample}, \code{Chr}, \code{Start}, \code{End}, \code{CN_call}, \code{post_CN*}, etc.}

\item{qploidy_standarize_result}{An object of class \code{qploidy_standardization} (output from \code{standardize}), used to extract BAF values for the BAF panel.}

\item{sample_id}{Character scalar. Which sample from \code{hmm_CN$Sample} to display. Defaults to the first unique value in \code{hmm_CN$Sample}.}

\item{cn_min, cn_max}{Numeric scalars. Y-axis limits for CN. Defaults span the min/max of \code{CN_call}.}

\item{show_window_lines}{Logical. If TRUE, show dashed vertical lines at window boundaries.}

\item{include_first_in_chr}{Logical. If TRUE, include the first window line in each chromosome.}

\item{line_color, line_alpha, line_width, line_linetype}{Appearance settings for window boundary lines.}

\item{heights}{Numeric vector of length 2 or 3. Relative heights of the BAF, z, and CN panels.}
}
\value{
A \code{ggplot} object (from ggpubr::ggarrange). Print to render, or add layers/scales as needed.
}
\description{
Plots a genome track for each window, showing the called copy number (CN) as a horizontal segment and coloring by the posterior probability of that call. Facets are split by chromosome. The top panel shows z-scores per window, colored by BAF weight; the bottom panel shows CN segments colored by posterior probability. The new top panel shows BAF values per SNP, colored by BAF weight, for the selected sample and chromosomes.
}
\details{
Posterior columns are detected by the prefix "post_CN" and matched to \code{CN_call} values, so the function is agnostic to the specific CN grid. The BAF panel shows per-SNP BAF values for the selected sample and chromosomes, colored by the BAF weight for the corresponding region. The z panel shows window z-scores, colored by BAF weight. The CN panel shows copy number segments colored by posterior probability.
}
\section{Expected columns}{

The function assumes posterior columns named exactly \code{post_CN<k>} for each copy-number state \code{k}. If your column naming differs, rename them before calling this function.
}

\examples{
\dontrun{
library(dplyr)
library(ggplot2)
toy <- data.frame(
  Sample   = "S1",
  Chr      = c("chr1","chr1","chr1"),
  Start    = c(1, 1e6, 2e6),
  End      = c(1e6-1, 2e6-1, 3e6-1),
  CN_call  = c(2,3,2),
  post_CN2 = c(0.95, 0.05, 0.9),
  post_CN3 = c(0.05, 0.94, 0.1)
)
# qploidy_standarize_result should be a qploidy_standardization object with $data containing BAF values
plot_cn_track(toy, qploidy_standarize_result, sample_id = "S1")
}

}
