% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm_utils.R
\name{viterbi}
\alias{viterbi}
\title{Viterbi decoding for a first-order HMM in log-space}
\usage{
viterbi(ll_em, logA, logpi0)
}
\arguments{
\item{ll_em}{A \eqn{W \times K} numeric matrix of emission log-likelihoods,
where \code{W} is the number of positions/windows and \code{K} is the
number of states. Column order must match \code{logA}.}

\item{logA}{A \eqn{K \times K} numeric matrix of log transition probabilities
where \code{logA[i, j]} is \eqn{\log p(s_t=j \mid s_{t-1}=i)}. Each row
should represent a valid \emph{log}-probability distribution.}

\item{logpi0}{Numeric length-\code{K} vector of initial state log
probabilities at position 1.}
}
\value{
An integer vector of length \code{W} with the 1-based indices of the
  most likely states at each position (Viterbi path).
}
\description{
Computes the most likely state sequence (Viterbi path) for a Hidden Markov
Model given per-position emission log-likelihoods and log transition/prior
probabilities.
}
\details{
This implementation operates in log-space for numerical stability. It stores
backpointers to reconstruct the optimal path after dynamic programming.
}
\examples{
set.seed(1)
W <- 5; K <- 3
ll_em <- matrix(rnorm(W*K), W, K)
A <- matrix(1/K, K, K); diag(A) <- 0.8; A <- A / rowSums(A)
logA <- log(A)
logpi0 <- log(rep(1/K, K))
vpath <- viterbi(ll_em, logA, logpi0)
vpath

}
