% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm_utils.R
\name{viterbi}
\alias{viterbi}
\title{Viterbi decoding for a first-order HMM in log-space}
\usage{
viterbi(ll_em, logA, logpi0)
}
\arguments{
\item{ll_em}{Numeric matrix (W x K). Emission log-likelihoods, where \code{W} is the number of positions/windows and \code{K} is the number of states. Column order must match \code{logA}.}

\item{logA}{Numeric matrix (K x K). Log transition probabilities, where \code{logA[i, j]} is \eqn{\log p(s_t=j | s_{t-1}=i)}. Each row should represent a valid log-probability distribution.}

\item{logpi0}{Numeric vector of length \code{K}. Initial state log-probabilities at position 1.}
}
\value{
Integer vector of length \code{W}. 1-based indices of the most likely states at each position (Viterbi path).
}
\description{
Computes the most likely state sequence (Viterbi path) for a Hidden Markov Model given per-position emission log-likelihoods and log transition/prior probabilities. Operates in log-space for numerical stability.
}
\details{
Stores backpointers to reconstruct the optimal path after dynamic programming. All calculations are performed in log-space for stability.
}
\examples{
set.seed(1)
W <- 5; K <- 3
ll_em <- matrix(rnorm(W*K), W, K)
A <- matrix(1/K, K, K); diag(A) <- 0.8; A <- A / rowSums(A)
logA <- log(A)
logpi0 <- log(rep(1/K, K))
vpath <- viterbi(ll_em, logA, logpi0)
vpath

}
